@page "/"
@using APIDrivingProject.Services;
@inject AuthService AuthService
@inject NavigationManager Navigation
@rendermode InteractiveServer

<div class="home-container">
    <div class="overlay"></div>
    <div class="content">
        <h1>Welcome to <span class="highlight">DriveManager</span></h1>
        <p>Manage your driving school with ease and efficiency.</p>
        <div class="buttons">
            <button class="btn btn-login" @onclick="NavigateToLogin">Login</button>
            <button class="btn btn-register" @onclick="NavigateToRegister">Register</button>
        </div>
    </div>
</div>

<style>
    .home-container {
        position: relative;
        height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        background: url('https://images.pexels.com/photos/14865958/pexels-photo-14865958.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=750&w=1260') center/cover no-repeat;
        overflow: hidden;
    }

    .overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.6);
        z-index: 1;
    }

    .content {
        position: relative;
        z-index: 2;
        text-align: center;
        color: white;
        padding: 20px;
        background: rgba(0, 0, 0, 0.7);
        border-radius: 15px;
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.6);
        max-width: 500px;
        width: 90%;
    }

        .content h1 {
            font-size: 2.5rem;
            margin-bottom: 20px;
        }

        .content p {
            font-size: 1.2rem;
            margin-bottom: 30px;
        }

    .highlight {
        color: #4CAF50;
    }

    .buttons {
        display: flex;
        justify-content: center;
        gap: 15px;
    }

    .btn {
        padding: 15px 25px;
        font-size: 1.2rem;
        font-weight: bold;
        cursor: pointer;
        border: none;
        border-radius: 5px;
        transition: transform 0.2s ease, background 0.3s ease;
    }

    .btn-login {
        background-color: #e50914;
        color: white;
    }

        .btn-login:hover {
            background-color: #f6121d;
            transform: scale(1.1);
        }

    .btn-register {
        background-color: #007bff;
        color: white;
    }

        .btn-register:hover {
            background-color: #0056b3;
            transform: scale(1.1);
        }
</style>

@code {
    private bool shouldRedirect = false;

    protected override void OnInitialized()
    {
        if (AuthService.IsAuthenticated)
        {
            shouldRedirect = true;
        }
    }

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender && shouldRedirect)
        {
            RedirectToDashboard();
        }
    }

    private void RedirectToDashboard()
    {
        if (AuthService.IsStudent)
        {
            Navigation.NavigateTo("student_dashboard");
        }
        else if (AuthService.IsInstructor)
        {
            Navigation.NavigateTo("/teacher_dashboard");
        }
        else if (AuthService.IsAdmin)
        {
            Navigation.NavigateTo("/admin_dashboard");
        }
    }

    private void NavigateToLogin()
    {
        Navigation.NavigateTo("/login");
    }

    private void NavigateToRegister()
    {
        Navigation.NavigateTo("/register");
    }
}
